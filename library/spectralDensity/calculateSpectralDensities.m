function [spectralDensityFirstOrder,spectralDensitySecondOrder] = ...
    calculateSpectralDensities(correlationFunction1,correlationFunction2 ...
    ,omega0,deltaT,averagingRegion)
% This function calculates the spectral densities of the given
% correlation functions

correlationFunctionLength = length(correlationFunction1);
spectralDensity1AllTimeSteps = 2*(deltaT*cumsum(correlationFunction1 ... 
        .*exp(-1i*omega0*deltaT*(0:correlationFunctionLength-1))));
spectralDensity2AllTimeSteps = 2*(deltaT*cumsum(correlationFunction2 ...
        .*exp(-2i*omega0*deltaT*(0:correlationFunctionLength-1))));

spectralDensityLength = length(spectralDensity1AllTimeSteps);
if round(averagingRegion(1)*spectralDensityLength) ~= 0
    spectralDensityFirstOrder = spectralDensity1AllTimeSteps(round( ...
        averagingRegion(1)*spectralDensityLength):round( ...
        averagingRegion(2)*spectralDensityLength));
    spectralDensitySecondOrder = spectralDensity2AllTimeSteps(round( ...
        averagingRegion(1)*spectralDensityLength):round( ...
        averagingRegion(2)*spectralDensityLength));
else
    spectralDensityFirstOrder = spectralDensity1AllTimeSteps(1:round( ...
        averagingRegion(2)*spectralDensityLength));
    spectralDensitySecondOrder = spectralDensity2AllTimeSteps(1:round( ...
        averagingRegion(2)*spectralDensityLength));
end

end

